<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Level - Steam Explorer</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&family=Rajdhani:wght@300;400;600;700&family=Press+Start+2P&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="languages.js"></script>
    <style>
        :root {
            --primary-color: #00f3ff;
            --secondary-color: #bc13fe;
            --bg-dark: #050b14;
            --bg-panel: rgba(16, 26, 46, 0.95);
            --glass-border: rgba(255, 255, 255, 0.1);
            --text-main: #e0e6ed;
            --text-dim: #94a3b8;
            --success: #00ff9d;
            --warning: #ffbd2e;
            --danger: #ff0055;
            --font-display: 'Orbitron', sans-serif;
            --font-body: 'Rajdhani', sans-serif;
        }

        /* TEMAS */
        body.theme-matrix { --primary-color: #00ff41; --secondary-color: #008f11; --bg-dark: #000000; --bg-panel: rgba(0, 20, 0, 0.95); }
        body.theme-fire { --primary-color: #ffbd2e; --secondary-color: #ff0055; --bg-dark: #1a0505; --bg-panel: rgba(40, 10, 10, 0.95); }
        body.theme-retro { --primary-color: #fca311; --secondary-color: #14213d; --bg-dark: #101010; --bg-panel: #1a1a1a; --glass-border: #404040; --text-main: #e5e5e5; --text-dim: #a0a0a0; --font-display: 'Press Start 2P', cursive; }
        body.theme-light { --primary-color: #007bff; --secondary-color: #6c757d; --bg-dark: #f8f9fa; --bg-panel: #ffffff; --glass-border: #dee2e6; --text-main: #212529; --text-dim: #6c757d; }
        body.theme-dark { --primary-color: #e83e8c; --secondary-color: #6f42c1; --bg-dark: #000000; --bg-panel: rgba(20, 20, 20, 0.95); --glass-border: rgba(255,255,255,0.15); --text-main: #f8f9fa; --text-dim: #adb5bd; }
        
        @keyframes rgb-color-cycle {
            0% { --primary-color: #ff00de; --secondary-color: #deff00; }
            25% { --primary-color: #00ffde; --secondary-color: #de00ff; }
            50% { --primary-color: #de00ff; --secondary-color: #00deff; }
            75% { --primary-color: #ffde00; --secondary-color: #00ffde; }
            100% { --primary-color: #ff00de; --secondary-color: #deff00; }
        }
        body.theme-rgb { animation: rgb-color-cycle 8s linear infinite; }

        /* TEMAS SAZONAIS */
        @keyframes snowfall { 0% {background-position: 0 0;} 100% {background-position: 500px 1000px, 400px 400px, 300px 300px;} }
        body.theme-seasonal-christmas::before {
            content: ''; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; pointer-events: none;
            background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10"><circle cx="5" cy="5" r="2" fill="white"/></svg>'), url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="6" height="6"><circle cx="3" cy="3" r="1" fill="white"/></svg>');
            background-size: 500px 500px, 400px 400px;
            animation: snowfall 30s linear infinite;
            opacity: 0.3;
        }
        body.theme-seasonal-christmas { --primary-color: #d92525; --secondary-color: #008f11; }
        body.theme-seasonal-halloween { --primary-color: #ff7518; --secondary-color: #4b0082; --bg-dark: #0a0500; }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background-color: var(--bg-dark); color: var(--text-main); font-family: var(--font-body); min-height: 100vh; }
        .container { width: 100%; max-width: 1280px; margin: 0 auto; padding: 20px; position: relative; z-index: 1; }

        /* HEADER */
        .main-header { display: flex; justify-content: space-between; align-items: center; padding: 20px 0; margin-bottom: 40px; border-bottom: 1px solid var(--glass-border); flex-wrap: wrap; gap: 15px; }
        .logo-area { display: flex; align-items: center; gap: 15px; }
        .logo-icon { font-size: 32px; color: var(--primary-color); }
        .site-title { font-family: var(--font-display); font-size: 24px; background: linear-gradient(90deg, var(--text-main), var(--primary-color)); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; }
        .main-nav { display: flex; gap: 10px; align-items: center; }
        .nav-btn { background: transparent; border: 1px solid transparent; color: var(--text-dim); padding: 8px 16px; border-radius: 20px; cursor: pointer; font-family: var(--font-display); text-decoration: none; font-size: 11px; transition: 0.3s; }
        .nav-btn:hover, .nav-btn.active { background: rgba(255,255,255,0.1); color: var(--primary-color); border-color: var(--glass-border); }
        .nav-btn.primary { background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); color: #000; font-weight: bold; padding: 8px 20px; border: none; }
        .nav-btn.primary:hover { transform: scale(1.05); box-shadow: 0 0 15px var(--primary-color); }
        .nav-menu-container { position: relative; }
        .nav-menu-btn { background: rgba(255,255,255,0.1); border: 1px solid var(--glass-border); color: var(--text-main); padding: 8px 15px; border-radius: 15px; cursor: pointer; font-family: var(--font-display); font-size: 11px; display: flex; align-items: center; gap: 8px; transition: 0.3s; }
        .nav-menu-btn:hover { background: rgba(255,255,255,0.15); color: var(--primary-color); }
        .nav-menu-dropdown { position: absolute; top: 100%; right: 0; margin-top: 10px; background: var(--bg-panel); border: 1px solid var(--glass-border); border-radius: 12px; min-width: 180px; padding: 10px 0; box-shadow: 0 10px 40px rgba(0,0,0,0.5); opacity: 0; visibility: hidden; transform: translateY(-10px); transition: all 0.3s ease; z-index: 1000; }
        .nav-menu-container:hover .nav-menu-dropdown { opacity: 1; visibility: visible; transform: translateY(0); }
        .nav-menu-dropdown a { display: flex; align-items: center; gap: 12px; padding: 12px 20px; color: var(--text-main); text-decoration: none; font-size: 14px; transition: 0.2s; }
        .nav-menu-dropdown a:hover { background: rgba(0,243,255,0.1); color: var(--primary-color); }
        .nav-menu-dropdown a i { width: 20px; text-align: center; color: var(--primary-color); }
        .header-controls { display: flex; gap: 15px; align-items: center; }
        .theme-select { background: rgba(255,255,255,0.1); border: 1px solid var(--glass-border); color: var(--text-main); padding: 8px 15px; border-radius: 20px; font-family: var(--font-body); cursor: pointer; }
        .theme-select option { background: var(--bg-dark); color: var(--text-main); }
        .seasonal-toggle { display: flex; align-items: center; gap: 5px; color: var(--text-dim); font-size: 12px; }
        .seasonal-toggle input { cursor: pointer; }

        /* XP HERO SECTION */
        .xp-hero {
            background: var(--bg-panel);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        .xp-hero::before {
            content: '';
            position: absolute;
            top: -50%; left: -50%;
            width: 200%; height: 200%;
            background: radial-gradient(circle at center, var(--primary-color) 0%, transparent 70%);
            opacity: 0.05;
            animation: pulse 4s ease-in-out infinite;
        }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }

        .level-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 120px; height: 120px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 50%;
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
            box-shadow: 0 0 40px rgba(0,243,255,0.4);
        }
        .level-badge-inner {
            width: 100px; height: 100px;
            background: var(--bg-dark);
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .level-number { font-family: var(--font-display); font-size: 36px; color: var(--primary-color); line-height: 1; }
        .level-label { font-size: 12px; color: var(--text-dim); text-transform: uppercase; }

        .xp-title-row {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }
        .xp-title { font-family: var(--font-display); font-size: 18px; color: var(--text-dim); }
        .xp-total { font-family: var(--font-display); font-size: 32px; color: var(--primary-color); text-shadow: 0 0 20px rgba(0,243,255,0.5); }

        .xp-progress-container {
            max-width: 500px;
            margin: 30px auto 0;
            position: relative;
            z-index: 1;
        }
        .xp-progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 14px;
        }
        .xp-current { color: var(--success); font-weight: bold; }
        .xp-needed { color: var(--text-dim); }
        .xp-progress-bar {
            height: 20px;
            background: rgba(0,0,0,0.5);
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid var(--glass-border);
        }
        .xp-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            border-radius: 10px;
            transition: width 1s ease;
            position: relative;
        }
        .xp-progress-fill::after {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }
        @keyframes shimmer { 0% { transform: translateX(-100%); } 100% { transform: translateX(100%); } }

        .xp-percent {
            text-align: center;
            margin-top: 10px;
            font-family: var(--font-display);
            font-size: 24px;
            color: var(--warning);
        }

        /* XP BREAKDOWN */
        .xp-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        .xp-stat-card {
            background: var(--bg-panel);
            border: 1px solid var(--glass-border);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            transition: 0.3s;
        }
        .xp-stat-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        .xp-stat-icon { font-size: 32px; margin-bottom: 10px; }
        .xp-stat-icon.achievements { color: var(--secondary-color); }
        .xp-stat-icon.platinas { color: #ffd700; }
        .xp-stat-icon.games { color: var(--success); }
        .xp-stat-value { font-family: var(--font-display); font-size: 28px; color: var(--text-main); }
        .xp-stat-label { font-size: 14px; color: var(--text-dim); margin-top: 5px; }
        .xp-stat-xp { font-size: 12px; color: var(--primary-color); margin-top: 8px; padding: 4px 10px; background: rgba(0,243,255,0.1); border-radius: 20px; display: inline-block; }

        /* LEVELS SECTION */
        .levels-section { margin-bottom: 40px; }
        .section-title {
            font-family: var(--font-display);
            font-size: 24px;
            margin-bottom: 25px;
            border-left: 4px solid var(--secondary-color);
            padding-left: 15px;
        }

        .levels-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
        }

        .level-card {
            background: var(--bg-panel);
            border: 2px solid var(--glass-border);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .level-card.unlocked {
            border-color: var(--success);
            background: linear-gradient(145deg, rgba(0,255,157,0.05), transparent);
        }
        .level-card.unlocked::before {
            content: '‚úì';
            position: absolute;
            top: 8px; right: 10px;
            color: var(--success);
            font-size: 14px;
        }
        .level-card.current {
            border-color: var(--primary-color);
            box-shadow: 0 0 20px rgba(0,243,255,0.3);
            animation: currentGlow 2s ease-in-out infinite alternate;
        }
        @keyframes currentGlow {
            from { box-shadow: 0 0 20px rgba(0,243,255,0.3); }
            to { box-shadow: 0 0 35px rgba(0,243,255,0.5); }
        }
        .level-card.locked {
            opacity: 0.5;
            filter: grayscale(50%);
        }
        .level-card.locked .level-card-icon { filter: grayscale(100%); }

        .level-card-icon {
            width: 60px; height: 60px;
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .level-card-icon svg {
            width: 100%; height: 100%;
        }
        .level-card-number {
            font-family: var(--font-display);
            font-size: 20px;
            color: var(--primary-color);
            margin-bottom: 5px;
        }
        .level-card-name {
            font-size: 12px;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .level-card-xp {
            font-size: 11px;
            color: var(--text-dim);
            margin-top: 8px;
            padding: 3px 8px;
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            display: inline-block;
        }

        /* REWARDS PREVIEW */
        .level-card-reward {
            margin-top: 10px;
            font-size: 10px;
            color: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        /* NO DATA MESSAGE */
        .no-data {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-dim);
        }
        .no-data-icon { font-size: 64px; margin-bottom: 20px; opacity: 0.3; }
        .no-data h2 { font-family: var(--font-display); margin-bottom: 10px; }
        .no-data a { color: var(--primary-color); }

        /* FOOTER */
        .page-footer {
            text-align: center;
            padding: 20px;
            color: var(--text-dim);
            font-size: 12px;
            border-top: 1px solid var(--glass-border);
        }

        /* ========== RESPONSIVE DESIGN ========== */
        @media (max-width: 768px) {
            .main-header { flex-direction: column; gap: 15px; padding: 15px 0; }
            .main-nav { flex-wrap: wrap; justify-content: center; gap: 8px; }
            .nav-btn { padding: 6px 12px; font-size: 10px; }
            .nav-menu-dropdown { position: fixed; top: auto; bottom: 0; left: 0; right: 0; border-radius: 20px 20px 0 0; min-width: 100%; }
            .site-title { font-size: 18px; }
            .logo-icon { font-size: 24px; }
            
            .xp-hero { padding: 25px 15px; }
            .level-badge { width: 100px; height: 100px; }
            .level-badge-inner { width: 80px; height: 80px; }
            .level-number { font-size: 28px; }
            .xp-total { font-size: 24px; }
            .xp-title { font-size: 14px; }
            
            .xp-breakdown { grid-template-columns: repeat(2, 1fr); gap: 12px; }
            .xp-stat-card { padding: 15px; }
            .xp-stat-value { font-size: 24px; }
            .xp-stat-label { font-size: 11px; }
            
            .xp-details { grid-template-columns: 1fr; }
            
            .rank-list { gap: 10px; }
            .rank-item { flex-direction: column; text-align: center; gap: 10px; padding: 15px; }
            .rank-position { width: 40px; height: 40px; font-size: 16px; }
            .rank-avatar { width: 50px; height: 50px; }
            
            .container { padding: 15px 10px; }
            .header-controls { flex-wrap: wrap; justify-content: center; }
        }

        @media (max-width: 480px) {
            .xp-breakdown { grid-template-columns: 1fr 1fr; gap: 8px; }
            .xp-stat-card { padding: 12px; }
            .xp-stat-value { font-size: 20px; }
            
            .level-badge { width: 80px; height: 80px; }
            .level-badge-inner { width: 65px; height: 65px; }
            .level-number { font-size: 22px; }
            .xp-total { font-size: 20px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="main-header">
            <div class="logo-area">
                <i class="fas fa-star logo-icon"></i>
                <h1 class="site-title" data-i18n-key="nav_xp">SISTEMA DE LEVEL</h1>
            </div>
            <nav class="main-nav">
                <a href="level.html" class="nav-btn primary active"><i class="fas fa-star"></i> <span data-i18n-key="nav_xp">LEVEL</span></a>
                <div class="nav-menu-container">
                    <button class="nav-menu-btn"><i class="fas fa-bars"></i> <span data-i18n-key="menu">MENU</span> <i class="fas fa-chevron-down" style="font-size:8px;"></i></button>
                    <div class="nav-menu-dropdown">
                        <a href="index.html"><i class="fas fa-gamepad"></i> <span data-i18n-key="nav_library">Biblioteca</span></a>
                        <a href="hall.html"><i class="fas fa-trophy"></i> <span data-i18n-key="hallOfFame">Hall da Fama</span></a>
                        <a href="roleta.html"><i class="fas fa-dice"></i> <span data-i18n-key="nav_roulette">Roleta</span></a>
                        <a href="prices.html"><i class="fas fa-chart-line"></i> <span data-i18n-key="priceHistory">Hist√≥rico Pre√ßos</span></a>
                        <a href="compare.html"><i class="fas fa-users"></i> <span data-i18n-key="compareProfiles">Comparar Perfis</span></a>
                        <a href="museum.html"><i class="fas fa-landmark"></i> Museu 3D</a>
                        <a href="wallpaper.html"><i class="fas fa-image"></i> <span data-i18n-key="nav_wallpaper">Wallpapers</span></a>
                    </div>
                </div>
            </nav>
            <div class="header-controls">
                <select id="themeSelector" onchange="changeTheme(this.value)" class="theme-select">
                    <option value="default">Padr√£o</option>
                    <option value="rgb">RGB</option>
                    <option value="retro">Retr√¥</option>
                    <option value="light">Claro</option>
                    <option value="dark">Escuro</option>
                </select>
                <select id="langSelector" onchange="setLanguage(this.value)" class="theme-select">
                    <option value="pt">üáßüá∑ PT</option>
                    <option value="en">üá∫üá∏ EN</option>
                    <option value="es">üá™üá∏ ES</option>
                    <option value="fr">üá´üá∑ FR</option>
                    <option value="de">üá©üá™ DE</option>
                    <option value="ru">üá∑üá∫ RU</option>
                    <option value="ja">üáØüáµ JA</option>
                    <option value="zh">üá®üá≥ ZH</option>
                </select>
                <div class="seasonal-toggle">
                    <input type="checkbox" id="seasonalCheck" onchange="toggleSeasonal(this.checked)">
                    <label for="seasonalCheck" data-i18n-key="seasonal">Sazonal</label>
                </div>
            </div>
        </header>

        <!-- MAIN CONTENT -->
        <div id="mainContent">
            <div class="no-data" id="noDataMessage">
                <div class="no-data-icon"><i class="fas fa-user-clock"></i></div>
                <h2>Nenhum dado encontrado</h2>
                <p>Fa√ßa uma busca na <a href="index.html">Biblioteca</a> para carregar suas estat√≠sticas de XP.</p>
            </div>

            <div id="xpContent" style="display: none;">
                <!-- XP HERO -->
                <section class="xp-hero">
                    <div class="level-badge">
                        <div class="level-badge-inner">
                            <span class="level-number" id="currentLevel">1</span>
                            <span class="level-label">Level</span>
                        </div>
                    </div>
                    <div class="xp-title-row">
                        <span class="xp-title">XP TOTAL:</span>
                        <span class="xp-total" id="totalXP">0</span>
                    </div>
                    <div class="xp-progress-container">
                        <div class="xp-progress-info">
                            <span class="xp-current" id="xpCurrent">0 XP</span>
                            <span class="xp-needed" id="xpNeeded">Pr√≥ximo: 0 XP</span>
                        </div>
                        <div class="xp-progress-bar">
                            <div class="xp-progress-fill" id="xpBar" style="width: 0%;"></div>
                        </div>
                        <div class="xp-percent" id="xpPercent">0%</div>
                    </div>
                </section>

                <!-- XP BREAKDOWN -->
                <section class="xp-breakdown">
                    <div class="xp-stat-card">
                        <div class="xp-stat-icon achievements"><i class="fas fa-medal"></i></div>
                        <div class="xp-stat-value" id="statAchievements">0</div>
                        <div class="xp-stat-label">Conquistas Desbloqueadas</div>
                        <div class="xp-stat-xp" id="xpFromAchievements">+0 XP</div>
                    </div>
                    <div class="xp-stat-card">
                        <div class="xp-stat-icon platinas"><i class="fas fa-trophy"></i></div>
                        <div class="xp-stat-value" id="statPlatinas">0</div>
                        <div class="xp-stat-label">Platinas (100%)</div>
                        <div class="xp-stat-xp" id="xpFromPlatinas">+0 XP</div>
                    </div>
                    <div class="xp-stat-card">
                        <div class="xp-stat-icon games"><i class="fas fa-gamepad"></i></div>
                        <div class="xp-stat-value" id="statGames">0</div>
                        <div class="xp-stat-label">Jogos Analisados</div>
                        <div class="xp-stat-xp" id="xpFromGames">+0 XP</div>
                    </div>
                </section>

                <!-- LEVELS GRID -->
                <section class="levels-section">
                    <h2 class="section-title">Todos os N√≠veis</h2>
                    <div class="levels-grid" id="levelsGrid"></div>
                </section>
            </div>
        </div>

        <footer class="page-footer">
            Steam Explorer &copy; 2025 - Sistema de Progress√£o
        </footer>
    </div>

    <script>
        // Level definitions with names, icons (SVG), and XP thresholds
        const LEVELS = [
            { level: 1, name: "Novato", xp: 0, icon: "seedling", color: "#888" },
            { level: 2, name: "Iniciante", xp: 400, icon: "star", color: "#a0a0a0" },
            { level: 3, name: "Aprendiz", xp: 900, icon: "book", color: "#87ceeb" },
            { level: 4, name: "Jogador", xp: 1600, icon: "gamepad", color: "#90ee90" },
            { level: 5, name: "Dedicado", xp: 2500, icon: "fire", color: "#ffa500" },
            { level: 6, name: "Veterano", xp: 3600, icon: "shield-alt", color: "#ff6b6b" },
            { level: 7, name: "Expert", xp: 4900, icon: "award", color: "#da70d6" },
            { level: 8, name: "Mestre", xp: 6400, icon: "crown", color: "#ffd700" },
            { level: 9, name: "Gr√£o-Mestre", xp: 8100, icon: "gem", color: "#00f3ff" },
            { level: 10, name: "Elite", xp: 10000, icon: "chess-king", color: "#ff00ff" },
            { level: 11, name: "Campe√£o", xp: 12100, icon: "medal", color: "#ff4500" },
            { level: 12, name: "Her√≥i", xp: 14400, icon: "bolt", color: "#ffff00" },
            { level: 13, name: "Lenda", xp: 16900, icon: "dragon", color: "#ff1493" },
            { level: 14, name: "M√≠tico", xp: 19600, icon: "hat-wizard", color: "#9400d3" },
            { level: 15, name: "Imortal", xp: 22500, icon: "infinity", color: "#00ffff" },
            { level: 16, name: "Divino", xp: 25600, icon: "sun", color: "#ffd700" },
            { level: 17, name: "Celestial", xp: 28900, icon: "moon", color: "#c0c0c0" },
            { level: 18, name: "C√≥smico", xp: 32400, icon: "globe", color: "#4169e1" },
            { level: 19, name: "Universal", xp: 36100, icon: "atom", color: "#00ced1" },
            { level: 20, name: "Transcendente", xp: 40000, icon: "eye", color: "#ff00ff" }
        ];

        // XP Multipliers
        const XP_PER_ACHIEVEMENT = 10;
        const XP_PER_PLATINUM = 500;
        const XP_PER_GAME = 25;

        function loadTheme() {
            const saved = localStorage.getItem('selectedTheme') || 'default';
            if (saved !== 'default') document.body.classList.add(`theme-${saved}`);
            document.getElementById('themeSelector').value = saved;
            applySeasonal();
        }

        function changeTheme(theme) {
            document.body.className = '';
            if (theme !== 'default') document.body.classList.add(`theme-${theme}`);
            localStorage.setItem('selectedTheme', theme);
            applySeasonal();
        }

        function toggleSeasonal(enabled) {
            localStorage.setItem('seasonalThemesEnabled', enabled);
            applySeasonal();
        }

        function applySeasonal() {
            const enabled = localStorage.getItem('seasonalThemesEnabled') === 'true';
            document.getElementById('seasonalCheck').checked = enabled;
            document.body.classList.remove('theme-seasonal-christmas', 'theme-seasonal-halloween');
            if (!enabled) return;
            const month = new Date().getMonth();
            if (month === 9) document.body.classList.add('theme-seasonal-halloween');
            else if (month === 11) document.body.classList.add('theme-seasonal-christmas');
        }

        function loadStats() {
            const statsJson = localStorage.getItem('userStats');
            if (!statsJson) {
                document.getElementById('noDataMessage').style.display = 'block';
                document.getElementById('xpContent').style.display = 'none';
                return;
            }

            const stats = JSON.parse(statsJson);
            document.getElementById('noDataMessage').style.display = 'none';
            document.getElementById('xpContent').style.display = 'block';

            // Calculate XP
            const xpFromAch = (stats.totalAchievementsUnlocked || 0) * XP_PER_ACHIEVEMENT;
            const xpFromPlat = (stats.totalPlatinum || 0) * XP_PER_PLATINUM;
            const xpFromGames = (stats.gamesCounted || 0) * XP_PER_GAME;
            const totalXP = xpFromAch + xpFromPlat + xpFromGames;

            // Calculate level
            const level = Math.max(1, Math.floor(Math.sqrt(totalXP / 100)));
            const xpForCurrent = 100 * (level * level);
            const xpForNext = 100 * ((level + 1) * (level + 1));
            const xpInLevel = totalXP - xpForCurrent;
            const xpNeeded = xpForNext - xpForCurrent;
            const percent = xpNeeded > 0 ? Math.floor((xpInLevel / xpNeeded) * 100) : 100;

            // Update UI
            document.getElementById('currentLevel').textContent = level;
            document.getElementById('totalXP').textContent = totalXP.toLocaleString() + ' XP';
            document.getElementById('xpCurrent').textContent = xpInLevel.toLocaleString() + ' XP';
            document.getElementById('xpNeeded').textContent = `Pr√≥ximo: ${xpNeeded.toLocaleString()} XP`;
            document.getElementById('xpBar').style.width = percent + '%';
            document.getElementById('xpPercent').textContent = percent + '% para o Level ' + (level + 1);

            // Update breakdown
            document.getElementById('statAchievements').textContent = (stats.totalAchievementsUnlocked || 0).toLocaleString();
            document.getElementById('statPlatinas').textContent = stats.totalPlatinum || 0;
            document.getElementById('statGames').textContent = stats.gamesCounted || 0;
            document.getElementById('xpFromAchievements').textContent = '+' + xpFromAch.toLocaleString() + ' XP';
            document.getElementById('xpFromPlatinas').textContent = '+' + xpFromPlat.toLocaleString() + ' XP';
            document.getElementById('xpFromGames').textContent = '+' + xpFromGames.toLocaleString() + ' XP';

            // Render levels grid
            renderLevelsGrid(level, totalXP);
        }

        function renderLevelsGrid(currentLevel, totalXP) {
            const grid = document.getElementById('levelsGrid');
            grid.innerHTML = '';

            LEVELS.forEach(lvl => {
                const isUnlocked = totalXP >= lvl.xp;
                const isCurrent = lvl.level === currentLevel;
                const isLocked = !isUnlocked;

                let cardClass = 'level-card';
                if (isCurrent) cardClass += ' current';
                else if (isUnlocked) cardClass += ' unlocked';
                else cardClass += ' locked';

                const card = document.createElement('div');
                card.className = cardClass;
                card.innerHTML = `
                    <div class="level-card-icon">
                        <i class="fas fa-${lvl.icon}" style="font-size: 40px; color: ${isLocked ? '#555' : lvl.color};"></i>
                    </div>
                    <div class="level-card-number" style="color: ${isLocked ? '#555' : lvl.color};">Level ${lvl.level}</div>
                    <div class="level-card-name">${lvl.name}</div>
                    <div class="level-card-xp">${lvl.xp.toLocaleString()} XP</div>
                    ${isCurrent ? '<div class="level-card-reward"><i class="fas fa-arrow-left"></i> VOC√ä EST√Å AQUI</div>' : ''}
                `;
                grid.appendChild(card);
            });

            // Add levels beyond 20 if user has high XP
            if (currentLevel > 20) {
                for (let i = 21; i <= currentLevel + 5; i++) {
                    const xpRequired = 100 * (i * i);
                    const isUnlocked = totalXP >= xpRequired;
                    const isCurrent = i === currentLevel;

                    let cardClass = 'level-card';
                    if (isCurrent) cardClass += ' current';
                    else if (isUnlocked) cardClass += ' unlocked';
                    else cardClass += ' locked';

                    const card = document.createElement('div');
                    card.className = cardClass;
                    card.innerHTML = `
                        <div class="level-card-icon">
                            <i class="fas fa-star" style="font-size: 40px; color: ${isUnlocked ? '#ff00ff' : '#555'};"></i>
                        </div>
                        <div class="level-card-number" style="color: ${isUnlocked ? '#ff00ff' : '#555'};">Level ${i}</div>
                        <div class="level-card-name">Al√©m da Lenda</div>
                        <div class="level-card-xp">${xpRequired.toLocaleString()} XP</div>
                        ${isCurrent ? '<div class="level-card-reward"><i class="fas fa-arrow-left"></i> VOC√ä EST√Å AQUI</div>' : ''}
                    `;
                    grid.appendChild(card);
                }
            }
        }

        // Init
        window.onload = () => {
            loadTheme();
            loadStats();
        };
    </script>
</body>
</html>
